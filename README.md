# デモ機管理アプリ (Demo Unit Loan Management)

デモ機や医療機器の貸出・在庫管理を行うための Streamlit アプリケーションです。
在庫ごとのステータス管理、貸出・返却時の構成品チェック、写真記録、不具合（Issue）管理機能を備え、厳格なトレーサビリティを実現します。
最新のアップデートにより、洗練されたホワイトベースのデザインと直感的なUIに刷新されました。

## 主な機能

### 1. デザイン & UI
- **モダンでスタイリッシュなホワイトベースデザイン**: 視認性の高いフォントと、アクセントカラー（ディープブルー）を採用。
- **カード型UI**: 各情報をカード形式で整理し、縦方向の中央揃え配置により情報の視認性を向上。
- **Material Symbolsアイコン**: Google Material Symbolsを使用し、洗練された印象に統一。

### 2. 在庫管理
- **カテゴリ管理**: 大分類ごとに機材を管理。
- **統計情報**: カテゴリを選択すると、そのカテゴリ内の機材ステータス集計（総台数、在庫あり、貸出中、要対応）を表示します。
- **ロット管理**: 機種ごとの実機（ロット）ステータス管理。

### 3. 貸出・返却履歴 (Enhanced)
- **詳細履歴表示**: 貸出・返却の履歴をタイムライン形式で表示。
- **構成品チェック詳細**: 各履歴を展開することで、その時点での構成品チェック結果（OK/NG、写真、コメント）を確認可能。
- **持出者表示**: 誰が持ち出したか（またはチェックを担当したか）を明記。

### 4. マスタ管理
- **機種・構成品管理**: 管理者による機種や構成品の登録・編集・削除機能。
- **データ初期化機能 (Admin Only)**: `admin@example.com` でログインした場合に限り、全データを初期化する管理者機能を提供。テスト運用後のリセットに利用可能。

### 5. 貸出管理 (Checkout)
- **貸出登録**: 持出日、貸出先、目的を記録。**青色のボタン**で直感的に操作可能。
- **構成品チェック**: 機種や個体に応じたチェックリスト（OK/NG判定）。
- **写真記録**: 貸出時の状態を写真で保存（必須）。
- **異常検知**: NG項目がある場合、自動的に「要対応」ステータスへ移行し、貸出禁止ロックがかかります。

### 6. 返却管理 (Return)
- **返却登録**: 貸出履歴に基づく返却処理。**赤色のボタン**で直感的に操作可能。
- **状態自動判定**: 返却時のチェック結果と既存の不具合状況に基づき、ステータスを自動更新。
- **写真・チェック**: 返却時も貸出時と同様に写真とチェックリストを必須化。

### 7. 不具合・取消管理 & 通知
- **Issue管理**: 不具合の記録と解消（Resolve）フロー。
- **取消機能 (Undo)**: 誤操作時のための貸出・返却取消機能。
- **アラート通知**: 不具合発生時に、カテゴリごとの通知グループへ自動ログ記録。

## 技術スタック
- **Frontend/Backend**: Python (Streamlit)
- **Database**: SQLite (`data/app.db`)
- **UI Styling**: Custom CSS (`src/styles.py`), Material Symbols Rounded
- **Environment**: Windows 11 (PowerShell)

## ディレクトリ構成
- `src/`: ソースコード
  - `views/`: 画面UIコンポーネント (home, master, loan, return, analytics, settings, login, setup)
  - `styles.py`: グローバルCSS定義・デザイン調整
  - `ui.py`: 共通UIコンポーネント
  - `database.py`: データベース操作
  - `auth.py`: 認証機能
- `data/`: データ保存先
  - `uploads/`: アップロード画像
- `.venv/`: 仮想環境

## セットアップと実行

### 必要要件
- Python 3.10+

### 初期設定 (初回のみ)
1. **依存関係のインストール**:
   ```powershell
   install_deps.bat
   ```

### アプリケーションの起動 (簡単起動)
以下のバッチファイルをダブルクリックしてください。
```powershell
Start_App.bat
```
自動的にサーバーが立ち上がり、ブラウザが開きます。

### 手動での起動
```powershell
& ".venv\Scripts\streamlit" run app.py
```

### 初期アカウント
- **Email**: `admin@example.com`
- **Password**: `admin123`
