# 機材貸出管理システム (Demo Unit Loan Management)

デモ機や医療機器の貸出・在庫管理を行うための Streamlit アプリケーションです。
在庫ごとのステータス管理、貸出時の構成品チェック、写真記録、不具合（Issue）管理機能を備えています。

## 主な機能

### 1. 在庫管理
- カテゴリ > 機種 > ロット の階層で機器を管理
- 各ロットのステータス管理（在庫あり、貸出中、要対応）
- ロットごとの構成品カスタマイズ（個体差分）

### 2. マスタ管理
- 管理者権限による機種・構成品の登録・編集
- ブレークダウン/セット品に対応したテンプレート管理

### 3. 貸出管理
- **貸出登録**: 持出日、貸出先、目的を記録
- **構成品チェック**: 機種や個体に応じたチェックリスト（OK/NG）
- **写真記録**: 貸出時の状態を写真で保存（必須）
- **異常検知**: NG項目がある場合、自動的に「要対応」ステータスへ移行し、貸出禁止ロックがかかります

## 技術スタック
- **Frontend/Backend**: Python (Streamlit)
- **Database**: SQLite (`data/app.db`)
- **Environment**: Windows 11 (PowerShell)

## ディレクトリ構成
- `src/`: ソースコード
  - `views/`: 画面UIコンポーネント
  - `database.py`: データベース操作・スキーマ定義
  - `logic.py`: 貸出チェックリスト生成などのビジネスロジック
  - `auth.py`: 認証関連
- `data/`: データ保存先
  - `uploads/`: アップロードされた画像ファイル
- `.venv/`: 仮想環境（ローカル）

## セットアップと実行

### 必要要件
- Python 3.10+

### インストール (Windows)
付属のバッチファイルを使用すると簡単です。

1. **初期セットアップ**:
   ```powershell
   install_deps.bat
   ```
   仮想環境の作成とライブラリのインストールが行われます。

### アプリケーションの起動
以下のバッチファイルをダブルクリックするか、ターミナルで実行してください。
```powershell
run_app.bat
```

または手動で:
```powershell
& ".venv\Scripts\streamlit" run app.py
```

ブラウザが自動的に開き、[http://localhost:8501](http://localhost:8501) にアクセスできます。

## 開発・検証
検証用スクリプトが含まれています。
- `verify_phase0.py`: 基本認証・DB基本機能のテスト
- `verify_phase1.py`: マスタ管理・在庫管理のテスト
- `verify_phase2.py`: 貸出プロセスのテスト
